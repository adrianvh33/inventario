{% extends "base.html" %}
{% block content%}
<nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div class="container">
      <a  class="navbar-brand" href="{% url 'productos.new'%}" >Crear</a>
      <a  class="navbar-brand btn btn-danger " href="{% url 'productos.deleteAll'%}" >Eliminar</a>
      </div>    
</nav>
    <h1>Estos son los productos:</h1>
    <div class="card">
        <div class="card-body">
        <form method='GET'>
            <div class="input-group">
                <input type="search" class="form-control rounded" name="q" value="{{ request.GET.q }}" placeholder="Escriba la referencia o nombre" aria-label="Search" aria-describedby="search-addon" />
                <button type="submit" class="btn btn-outline-primary">Buscar</button>
            </div>
        </form>
        </div>
    </div>
    <div class="table-responsive " ></div>
    <form method='GET' id="filtro">
    <table  class="table table-striped table-sm ">
        <input type="text" id='orderID' name="order" value="" hidden>
        <tr>
            <th><a href="#" onclick="submit('referencia')">Referencia</a></th>
            <th><a href="#" onclick="submit('nombre')"> Nombre</a> </th>
            <th><a href="#" onclick="submit('cantidadSistema')"> Cantidad sistema</a></th>
            <th>Total</th>
        </tr>
        {% for producto in productos%}
        <tr>
            <td><a href="{% url 'productos.detail' pk=producto.id %}">{{producto.referencia}}</a></td>
            <td><a href="{% url 'productos.detail' pk=producto.id %}">{{producto.nombre}}</a></td>
            <td>{{producto.cantidadSistema}}</td>
            <td>{{producto.enTienda|add:producto.enBloque2|add:producto.enBloque5 }}</td>
        </tr>
        {% endfor %}
    </table>
    </form>
    </div>
    <script>
        let firstTime = true;
        let asc;
        function submit(order){
        document.getElementById('orderID').value = order;
        document.getElementById('filtro').submit();
        }
    </script>
{% endblock %}
